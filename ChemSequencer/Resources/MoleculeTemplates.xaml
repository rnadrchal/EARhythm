<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:chem="clr-namespace:Egami.Chemistry.Model;assembly=Egami.Chemistry"
                    xmlns:converters="clr-namespace:Egami.Sequencer.UI.Converters;assembly=Egami.Sequencer.UI"
                    xmlns:wpf="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
                    xmlns:viewModels="clr-namespace:ChemSequencer.ViewModels">

    <converters:ByteArrayToImageSourceConverter x:Key="ByteArrayToImageSource" />
    <converters:NotNullToVisibilityConverter x:Key="NotNullToVisibility" />
    <BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
    <viewModels:BondToStringConverter x:Key="BondToString" />
    <viewModels:ByteArrayToCroppedImageConverter x:Key="CroppedImage" />

    <Style TargetType="TextBlock" x:Key="PropertyLabelStyle">
        <Setter Property="Foreground" Value="#AAA" />
        <Setter Property="HorizontalAlignment" Value="Right" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Margin" Value="3,3,5,3" />
    </Style>

    <Style TargetType="TextBlock" x:Key="PropertyStyle">
        <Setter Property="Foreground" Value="#FFF" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Margin" Value="0,3"></Setter>
    </Style>

    <Style TargetType="TextBlock" x:Key="SectionHeaderStyle">
        <Setter Property="FontWeight" Value="Bold" />
    </Style>

    <Style TargetType="Border" x:Key="SectionHeaderBorderStyle">
        <Setter Property="Background" Value="#444" />
        <Setter Property="BorderBrush" Value="#666" />
        <Setter Property="BorderThickness" Value="0,0,0,1" />
        <Setter Property="Padding" Value="5" />
    </Style>

    <DataTemplate DataType="{x:Type chem:AtomProperties}" x:Key="AtomPropTemplate">
        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
            <TextBlock Text="H" VerticalAlignment="Center" />
            <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                <TextBlock Text="↗" Foreground="#AAA" VerticalAlignment="Bottom"/>
                <TextBlock Text="↘" Foreground="#AAA" VerticalAlignment="Top" />
            </StackPanel>
            <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                <TextBlock Text="{Binding ImplicitHydrogenCount}" FontSize="10" VerticalAlignment="Top" Margin="0,0,0,2"
                           ToolTip="Number of hydrogen atoms assumed to be attached."/>
                <TextBlock Text="{Binding TotalHydrogenCount}" FontSize="10" VerticalAlignment="Bottom" Margin="0,2,0,0"
                           ToolTip="Total hydrogen count"/>
            </StackPanel>
            <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                <TextBlock Text="{Binding Degree}"
                           Margin="10,0,0,2"
                           FontSize="10"
                           ToolTip="Degree: the number of other atoms directly bonded."/>
                <TextBlock Text="{Binding Valence}" FontSize="10"
                           VerticalAlignment="Bottom" Margin="10,2,0,0"
                           ToolTip="Valence: number of bonds that can be formed." />
            </StackPanel>
            <Border BorderBrush="#666" BorderThickness="1"
                    Margin="5,0,0,0" Padding="5" 
                    MaxWidth="150"
                    Visibility="{Binding HasTags, Converter={StaticResource BooleanToVisibility}}">
                <ItemsControl ItemsSource="{Binding Tags}"
                              VerticalAlignment="Center">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock FontSize="10">
                                <Run Text=" • " Foreground="#888" /><Run  Text="{Binding Mode=OneWay}"/>
                            </TextBlock>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>

            </Border>
        </StackPanel>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:BondEdge}">
        <StackPanel Orientation="Horizontal">
            <Border Width="30" Height="30" 
                    Margin="5,2,0,2"
                    Background="White">
                <TextBlock Text="{Binding From}" Foreground="Black" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           FontSize="16"/>

            </Border>
            <TextBlock Text="{Binding Order, Converter={StaticResource BondToString}}"
                       FontSize="24" Width="40" TextAlignment="Center"
                       VerticalAlignment="Center"/>
            <Border Width="30" Height="30" 
                    Background="White">
                <TextBlock Text="{Binding To}" Foreground="Black" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           FontSize="16"/>

            </Border>
            <Border BorderBrush="#666" BorderThickness="1"
                    Margin="5,2,0,2" Padding="5" 
                    MaxWidth="150"
                    Visibility="{Binding HasTags, Converter={StaticResource BooleanToVisibility}}">
                <ItemsControl ItemsSource="{Binding Tags}"
                              VerticalAlignment="Center">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock FontSize="10">
                                <Run Text=" • " Foreground="#888" /><Run  Text="{Binding Mode=OneWay}"/>
                            </TextBlock>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>

            </Border>
        </StackPanel>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:AtomNode}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0" Orientation="Horizontal">
                <TextBlock Text="{Binding Index}"
                           Margin="5,0,0,0" VerticalAlignment="Center"
                           Foreground="#DDD" />
                <Border Width="50" Height="50" Background="#FFF" Margin="10,2,2,2"
                        VerticalAlignment="Top">
                    <Grid>
                        <TextBlock Text="{Binding Element}"
                                   Foreground="Black" FontSize="16" FontWeight="Bold"
                                   VerticalAlignment="Center" HorizontalAlignment="Center" />
                        <TextBlock Text="{Binding ElementProps.AtomicNumber}"
                                   VerticalAlignment="Top" HorizontalAlignment="Left"
                                   Foreground="#555" FontSize="10"
                                   Margin="2,2"
                                   ToolTip="Atomic number"/>
                        <TextBlock Text="{Binding ElementProps.AtomicWeight}"
                                   VerticalAlignment="Bottom" HorizontalAlignment="Left"
                                   Foreground="#555" FontSize="10"
                                   Margin="2,2" 
                                   ToolTip="Atomic weight"/>
                        <TextBlock Text="{Binding ElementProps.ElectronegativityPauling}"
                                   VerticalAlignment="Top" HorizontalAlignment="Right"
                                   Foreground="#F00" FontSize="10"
                                   Margin="2,2"
                                   ToolTip="Pauling electronegativity"/>
                        <TextBlock Text="{Binding AtomProps.FormalCharge}"
                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                   Foreground="#F00" FontSize="10"
                                   Margin="2,2" 
                                   ToolTip="Formal charge"/>
                    </Grid>
                </Border>
                <ContentControl Content="{Binding AtomProps}" ContentTemplate="{StaticResource AtomPropTemplate}"
                                VerticalAlignment="Center" Margin="5,0,0,0"/>

            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:ChemicalProperties}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition/>
            </Grid.RowDefinitions>

            <Separator Grid.Column="1" Grid.Row="0" Grid.RowSpan="5"
                       HorizontalAlignment="Right" />

            <TextBlock Grid.Row="0" Grid.Column="0"
                       Text="Mol. Weight" 
                       Style="{StaticResource PropertyLabelStyle}" />
            <TextBlock Grid.Row="0" Grid.Column="1" 
                       Text="{Binding MolecularWeight}"
                       Style="{StaticResource PropertyStyle}" />

            <TextBlock Grid.Row="0" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="Exact Mass"></TextBlock>
            <TextBlock Grid.Row="0" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding ExactMass}"></TextBlock>

            <TextBlock Grid.Row="1" Grid.Column="0"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="HBD"></TextBlock>
            <TextBlock Grid.Row="1" Grid.Column="1"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding HydrogenBondDonorCount}"
                       ToolTip="Hydrogen bond donor count" />

            <TextBlock Grid.Row="1" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="HBA"></TextBlock>
            <TextBlock Grid.Row="1" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding HydrogenBondAcceptorCount}"
                       ToolTip="Hydrogen bond acceptor count" />

            <TextBlock Grid.Row="2" Grid.Column="0"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="RBC"></TextBlock>
            <TextBlock Grid.Row="2" Grid.Column="1"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding RotatableBondCount}"
                       ToolTip="Rotatable Bond Count" />

            <TextBlock Grid.Row="2" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="Charge"></TextBlock>
            <TextBlock Grid.Row="2" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding Charge}"></TextBlock>

            <TextBlock Grid.Row="3" Grid.Column="0"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="XLogP" />
            <TextBlock Grid.Row="3" Grid.Column="1"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding XLogP}"
                       ToolTip="Octanol-water partition coefficient" />

            <TextBlock Grid.Row="3" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="TPSA"></TextBlock>
            <TextBlock Grid.Row="3" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding TopologicalPolarSurfaceArea}"
                       ToolTip="Topological Polar Surface Area (TPSA) is a crucial molecular descriptor in medicinal chemistry, calculating the surface area of polar atoms (like Oxygen, Nitrogen, and their attached Hydrogens) in a molecule." />
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:MoleculeModel}" x:Key="MoleculeDisplayTemplate">
        <GroupBox Style="{StaticResource ChemGroupBoxStyle}"
                  Visibility="{Binding Converter={StaticResource NotNullToVisibility}}">
            <GroupBox.Header>
                <TextBlock FontWeight="Bold" FontSize="24" Text="{Binding PreferredName}"></TextBlock>
            </GroupBox.Header>
            <ScrollViewer HorizontalScrollBarVisibility="Hidden" 
                          VerticalScrollBarVisibility="Auto">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="{Binding Ids.MolecularFormula}"
                               Margin="5,0,5,5"
                               FontSize="16"></TextBlock>
                    <Image Grid.Row="1" Source="{Binding DepictionPng, Converter={StaticResource CroppedImage}}" Width="300"
                           Stretch="Uniform"/>
                    <ContentControl Grid.Row="2" Content="{Binding Properties}" />
                    <Border Grid.Row="3" Style="{StaticResource SectionHeaderBorderStyle}">
                        <TextBlock Text="Atoms" Style="{StaticResource SectionHeaderStyle}" />
                    </Border>
                    <ItemsControl Grid.Row="4" ItemsSource="{Binding Graph.Atoms}" />
                    <Border Grid.Row="5" Style="{StaticResource SectionHeaderBorderStyle}">
                        <TextBlock Text="Bonds" Style="{StaticResource SectionHeaderStyle}" />
                    </Border>
                    <ItemsControl Grid.Row="6" ItemsSource="{Binding Graph.Bonds}" />
                </Grid>
            </ScrollViewer>
        </GroupBox>
    </DataTemplate>
</ResourceDictionary>
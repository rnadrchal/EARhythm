<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:chem="clr-namespace:Egami.Chemistry.Model;assembly=Egami.Chemistry"
                    xmlns:converters="clr-namespace:Egami.Sequencer.UI.Converters;assembly=Egami.Sequencer.UI"
                    xmlns:wpf="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
                    xmlns:viewModels="clr-namespace:ChemSequencer.ViewModels"
                    xmlns:spectrum="clr-namespace:Egami.Chemistry.Spectrum;assembly=Egami.Chemistry">

    <converters:ByteArrayToImageSourceConverter x:Key="ByteArrayToImageSource" />
    <converters:NotNullToVisibilityConverter x:Key="NotNullToVisibility" />
    <BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
    <viewModels:BondToStringConverter x:Key="BondToString" />
    <viewModels:ByteArrayToCroppedImageConverter x:Key="CroppedImage" />
    <converters:WavelengthToBrushConverter x:Key="WavelengthToBrush" />

    <Style TargetType="TextBlock" x:Key="PropertyLabelStyle">
        <Setter Property="Foreground" Value="#AAA" />
        <Setter Property="HorizontalAlignment" Value="Right" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Margin" Value="3,3,5,3" />
    </Style>

    <Style TargetType="TextBlock" x:Key="PropertyStyle">
        <Setter Property="Foreground" Value="#FFF" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Margin" Value="0,3"></Setter>
    </Style>

    <DataTemplate DataType="{x:Type chem:AtomProperties}" x:Key="AtomPropTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Border BorderBrush="#444" BorderThickness="1" Padding="5"
                    Background="#AAA" Grid.Column="0">
                <Grid TextBlock.FontSize="10" TextBlock.Foreground="#222">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Grid.Column="0" HorizontalAlignment="Right">
                        <Run Text="n" /><Run Text="H" BaselineAlignment="Subscript" FontSize="8" /><Run Text=" = "></Run>
                    </TextBlock>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding TotalHydrogenCount}" 
                               FontSize="10"
                               ToolTip="Total hydrogen count"/>
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="CN = " HorizontalAlignment="Right" />
                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Degree}"
                               FontSize="10"
                               ToolTip="Coordination number: the number of other atoms directly bonded."/>
                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Val = " HorizontalAlignment="Right" />
                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Valence}" FontSize="10"
                               ToolTip="Valence: number of bonds that can be formed." />

                </Grid>
            </Border>
            <Border Grid.Column="1" Margin="2,0" Padding="5">
                <WrapPanel Orientation="Vertical" MaxWidth="50" MaxHeight="50" TextBlock.FontSize="10"
                           VerticalAlignment="Center">
                    <TextBlock Text="⇐" Foreground="LightGreen" Margin="3,0"
                               Visibility="{Binding IsHBondAcceptor, Converter={StaticResource BooleanToVisibility}}"
                               ToolTip="H-Bond acceptor" />
                    <TextBlock Text="⇒" Foreground="OrangeRed" Margin="3,0"
                               Visibility="{Binding IsHBondDonor, Converter={StaticResource BooleanToVisibility}}" 
                               ToolTip="H-Bond donor"/>
                    <TextBlock Text="◉" Foreground="Yellow" Margin="3,0"
                               Visibility="{Binding IsHeteroAtom, Converter={ StaticResource BooleanToVisibility}}" 
                               ToolTip="Hetero atom" />
                    <TextBlock Foreground="LightSkyBlue" Margin="3,0"
                               Visibility="{Binding IsInRing, Converter={StaticResource BooleanToVisibility}}" 
                               ToolTip="Ring atom">
                        <Image Source="/Resources/Images/aromatic.png" Width="16" Height="16" />

                        <Run Text="{Binding SmallestRingSize}" />
                    </TextBlock>
                    <TextBlock Margin="3,0"
                               Visibility="{Binding IsAromatic, Converter={StaticResource BooleanToVisibility}}" 
                               ToolTip="aromatic">
                        <Run Text="◯" Foreground="Orange" /><Run Text="{Binding SmallestRingSize}" />
                    </TextBlock>
                    <TextBlock Visibility="{Binding Hybridization, Converter={StaticResource NotNullToVisibility}}"
                               Foreground="Aqua"
                               ToolTip="Hybridization">
                        <Run Text="∷" /><Run Text="{Binding Hybridization}" />
                    </TextBlock>
                    <TextBlock Foreground="Red" 
                               Visibility="{Binding PartialCharge, Converter={StaticResource NotNullToVisibility}}"
                               ToolTip="Partial charge">
                        <Run Text="±" /><Run Text="{Binding PartialCharge}" />
                    </TextBlock>
                </WrapPanel>
            </Border>

        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:BondEdge}">
        <StackPanel Orientation="Horizontal">
            <Border Width="40" Height="40" 
                    Margin="5,2,0,2"
                    Background="White"
                    VerticalAlignment="Center">
                <TextBlock Text="{Binding From}" Foreground="Black" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           FontSize="16"/>

            </Border>
            <TextBlock Text="{Binding Order, Converter={StaticResource BondToString}}"
                       FontSize="24" Width="40" TextAlignment="Center"
                       VerticalAlignment="Center"/>
            <Border Width="40" Height="40" 
                    Background="White">
                <TextBlock Text="{Binding To}" Foreground="Black" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           FontSize="16"/>

            </Border>
            <Border Margin="2" Padding="5" Height="40"
                    TextBlock.FontSize="10">
                <WrapPanel Orientation="Vertical">
                    <TextBlock Visibility="{Binding Length3D, Converter={StaticResource NotNullToVisibility}}"
                               Margin="5,0,0,0">
                        <Run Text="⇿ " /><Run Text="{Binding Length3D, StringFormat=N2}" />
                    </TextBlock>
                    <TextBlock Visibility="{Binding PolarityProxy, Converter={StaticResource NotNullToVisibility}}" 
                               Foreground="LightGreen" Margin="5,0,0,0"
                               ToolTip="electronegativity difference" >
                        <Run Text="ΛEN" FontStyle="Italic" />     
                        <Run Text="{Binding PolarityProxy, StringFormat=N2}"></Run>
                    </TextBlock>
                    <TextBlock Visibility="{Binding IsConjugated, Converter={StaticResource BooleanToVisibility}}" Text="∷" 
                               Margin="5,0,0,0" ToolTip="conjugated"/>
                    <TextBlock Visibility="{Binding IsRotatable, Converter={StaticResource BooleanToVisibility}}" Text="↷" FontSize="12" Margin="5,0,0,0"
                               ToolTip="rotable"></TextBlock>
                    <Image Visibility="{Binding IsAromatic, Converter={StaticResource BooleanToVisibility}}" 
                           Source="/Resources/Images/aromatic.png" Width="16" Height="16" Margin="5,0,0,0"
                           ToolTip="aromatic"/>
                    <StackPanel Visibility="{Binding IsInRing, Converter={StaticResource BooleanToVisibility}}"
                                Orientation="Horizontal" Margin="5,0,0,0">
                        <Image Source="/Resources/Images/aromatic.png" Width="14" Height="14" 
                               ToolTip="aromatic"/>
                        <TextBlock Text="{Binding SmallestRingSize}" Margin="4,0,0,0"
                                   Foreground="LightBlue" ToolTip="Smallest ring size"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="5,0,0,0"
                                Visibility="{Binding Stereo, Converter={StaticResource NotNullToVisibility}}">
                        <Image Source="/Resources/Images/stereo.png" Width="32" Height="32" />
                        <TextBlock Text="{Binding Stereo}" />
                    </StackPanel>
                    <TextBlock Foreground="Orange" Margin="5,0,0,0"
                               ToolTip="Bond class">
                        <Run Text="{Binding BondClass}"></Run>
                    </TextBlock>
                </WrapPanel>

            </Border>
        </StackPanel>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:AtomNode}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0" Orientation="Horizontal">
                <TextBlock Text="{Binding Index}" Width="20"
                           Margin="5,0,0,0" VerticalAlignment="Center"
                           TextAlignment="Center"
                           FontWeight="Bold"
                           Foreground="#DDD" />
                <Border Width="50" Height="50" Background="#FFF" Margin="10,2,2,2"
                        VerticalAlignment="Top">
                    <Grid>
                        <TextBlock Text="{Binding Element}"
                                   Foreground="Black" FontSize="16" FontWeight="Bold"
                                   VerticalAlignment="Center" HorizontalAlignment="Center" />
                        <TextBlock Text="{Binding ElementProps.AtomicNumber}"
                                   VerticalAlignment="Top" HorizontalAlignment="Left"
                                   Foreground="#555" FontSize="10"
                                   Margin="2,2"
                                   ToolTip="Atomic number"/>
                        <TextBlock Text="{Binding ElementProps.AtomicWeight}"
                                   VerticalAlignment="Bottom" HorizontalAlignment="Left"
                                   Foreground="#555" FontSize="10"
                                   Margin="2,2" 
                                   ToolTip="Atomic weight"/>
                        <TextBlock Text="{Binding ElementProps.ElectronegativityPauling}"
                                   VerticalAlignment="Top" HorizontalAlignment="Right"
                                   Foreground="#F00" FontSize="10"
                                   Margin="2,2"
                                   ToolTip="Pauling electronegativity"/>
                        <TextBlock Text="{Binding AtomProps.FormalCharge}"
                                   VerticalAlignment="Bottom" HorizontalAlignment="Right"
                                   Foreground="#F00" FontSize="10"
                                   Margin="2,2" 
                                   ToolTip="Formal charge"/>
                    </Grid>
                </Border>
                <Border Padding="3" Background="#000" BorderBrush="#444" BorderThickness="1" Margin="2,0">
                    <ItemsControl ItemsSource="{Binding EmissionLines}" 
                                  VerticalAlignment="Center"
                                  Margin="5,0">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="{x:Type spectrum:SpectralLine}">
                                <TextBlock FontSize="10" Foreground="{Binding WavelengthNm, Converter={StaticResource WavelengthToBrush}}">
                                    <Run Text="{Binding WavelengthNm, Mode=OneWay, StringFormat=N1}" /><Run Text="nm" />
                                </TextBlock>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Border>
                <ContentControl Content="{Binding AtomProps}" ContentTemplate="{StaticResource AtomPropTemplate}"
                                VerticalAlignment="Center" Margin="5,0,0,0"/>

            </StackPanel>
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:ChemicalProperties}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition/>
            </Grid.RowDefinitions>

            <Separator Grid.Column="1" Grid.Row="0" Grid.RowSpan="5"
                       HorizontalAlignment="Right" />

            <TextBlock Grid.Row="0" Grid.Column="0"
                       Text="Mol. Weight" 
                       Style="{StaticResource PropertyLabelStyle}" />
            <TextBlock Grid.Row="0" Grid.Column="1" 
                       Text="{Binding MolecularWeight}"
                       Style="{StaticResource PropertyStyle}" />

            <TextBlock Grid.Row="0" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="Exact Mass"></TextBlock>
            <TextBlock Grid.Row="0" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding ExactMass}"></TextBlock>

            <TextBlock Grid.Row="1" Grid.Column="0"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="HBD"></TextBlock>
            <TextBlock Grid.Row="1" Grid.Column="1"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding HydrogenBondDonorCount}"
                       ToolTip="Hydrogen bond donor count" />

            <TextBlock Grid.Row="1" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="HBA"></TextBlock>
            <TextBlock Grid.Row="1" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding HydrogenBondAcceptorCount}"
                       ToolTip="Hydrogen bond acceptor count" />

            <TextBlock Grid.Row="2" Grid.Column="0"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="RBC"></TextBlock>
            <TextBlock Grid.Row="2" Grid.Column="1"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding RotatableBondCount}"
                       ToolTip="Rotatable Bond Count" />

            <TextBlock Grid.Row="2" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="Charge"></TextBlock>
            <TextBlock Grid.Row="2" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding Charge}"></TextBlock>

            <TextBlock Grid.Row="3" Grid.Column="0"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="XLogP" />
            <TextBlock Grid.Row="3" Grid.Column="1"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding XLogP}"
                       ToolTip="Octanol-water partition coefficient" />

            <TextBlock Grid.Row="3" Grid.Column="2"
                       Style="{StaticResource PropertyLabelStyle}"
                       Text="TPSA"></TextBlock>
            <TextBlock Grid.Row="3" Grid.Column="3"
                       Style="{StaticResource PropertyStyle}"
                       Text="{Binding TopologicalPolarSurfaceArea}"
                       ToolTip="Topological Polar Surface Area (TPSA) is a crucial molecular descriptor in medicinal chemistry, calculating the surface area of polar atoms (like Oxygen, Nitrogen, and their attached Hydrogens) in a molecule." />
        </Grid>
    </DataTemplate>

    <DataTemplate DataType="{x:Type chem:MoleculeModel}" x:Key="MoleculeDisplayTemplate">
        <GroupBox Style="{StaticResource GroupBoxStyle}"
                  Visibility="{Binding Converter={StaticResource NotNullToVisibility}}">
            <GroupBox.Header>
                <TextBlock FontWeight="Bold" FontSize="24" Text="{Binding PreferredName}"
                           TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"></TextBlock>
            </GroupBox.Header>
            <ScrollViewer HorizontalScrollBarVisibility="Hidden" 
                          VerticalScrollBarVisibility="Auto">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="{Binding Ids.MolecularFormula}"
                               Margin="5,0,5,5"
                               FontSize="16"></TextBlock>
                    <ContentControl Grid.Row="2" Content="{Binding Properties}" />
                    <Border Grid.Row="3" Style="{StaticResource SectionHeaderBorderStyle}">
                        <TextBlock Text="Atoms" Style="{StaticResource SectionHeaderStyle}" />
                    </Border>
                    <ItemsControl Grid.Row="4" ItemsSource="{Binding Graph.Atoms}" />
                    <Border Grid.Row="5" Style="{StaticResource SectionHeaderBorderStyle}">
                        <TextBlock Text="Bonds" Style="{StaticResource SectionHeaderStyle}" />
                    </Border>
                    <ItemsControl Grid.Row="6" ItemsSource="{Binding Graph.Bonds}" />
                </Grid>
            </ScrollViewer>
        </GroupBox>
    </DataTemplate>

</ResourceDictionary>